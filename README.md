# ISSC
Скрипт получения информации о состоянии компьютера

Используется 2 модуля:

- [PSWriteExcel] - [разработка позаимствована из репозитория EvotecIT](https://github.com/EvotecIT/PSWriteExcel)

- [ISSC_modules] - Собственная разработка с использованием функций найденных на просторах Интернет

- [Config_testPC.ps1] - Файл конфигурации

# ToDo

### HARD
- [x] CPU (тип и частота)
- [x] RAM (всего/свободно)
- [x] HDD Диск С (всего/свободно)
- [x] Сетевые интерфейсы (ip, mac, dhcp)
- [x] Статические маршруты
### OS,Soft
- [x] ОС (наименование, версия, билд)
- [x] Список установленных обновлений
- [x] Список установленного ПО
### ACL
- [x] Список расшаренных папок
- [x] Список УЗ в группе локальных администраторов
- [ ] Список локальных пользователей
- [ ] Список локальных групп
### Status
- [x] Список запущенных служб с их состоянием
- [x] Список запущенных процессов
- [x] Список открытых портов и их владельцев
- [x] Текущий пользователь (локальный вход) 
### Custom. Еще не реализован.
- [ ] Список пользователей в указанной в списке группе
- [ ] Список файлов в каталогах по списку
- [ ] Список наличия или отсутствия файлов по списку
- [ ] Список значения ключей реестра по списку
- [ ] Список значений параметров ГПО по списку

### Выгрузка результатов
- [x] Excel
- [x] JSON - с компресией или без

### Функции
- [x] Start-TimeLog - Функция запуска таймера в начале запуска скрипта
- [x] Stop-TimeLog - Функция остановки таймера в конце скрипта
- [x] Write-log - Функция логирования действий скрипта с выводом разными цветами
- [x] Get-UserVariable - Функция получения пользовательских переменных
- [x] Get-DomainWrk - Функция получения ПК в определенной OU
- [x] get-netstat - Функция получения вывода команды  NETSTAT.EXE
- [x] Get-NIC - Функция поиска локальных интерфейсов, вывода IP, MASK, DNS, DHCP
- [x] Get-MicrosoftUpdates - Функция вывода установленых обновлений
- [x] Get-LocalAdminMembers - Функция вывода пользователей в группе локальных администраторов
- [ ] Get-LocalGroupMembers - Функция вывода локальных пользователей и групп. Разработана, но фактически не используется
- [x] Get-shared - Функция вывода расшареных ресурсов
- [x] Get-ComputerApplications - Функция вывода устновленного программного обеспечения
- [x] get-iproute - Функция вывода постоянных маршрутов
- [x] get-loggedonuser - Функция вывода залогиненых пользователей с указанием их типов
- [x] Get-ComputerMissingDrivers - Функция вывода драйверов имеющих ошибки
- [x] Get-FirmwareEnvironmentVariableAPI - Функция получения типа BIOS\UAFI
- [x] Get-ComputerCPU - Функция вывода информации об установленных процессорах
- [x] Get-ComputerGPU - Функция вывода информации об установленной видео карте
- [x] ConvertTo-OperatingSystem - Функция конвертации короткого представления ОС в ее наименование
- [x] Get-ComputerOperatingSystem - Функция поредоставления данных об ОС
- [x] Get-ComputerSystem - Функция предоставления данных об системном блоке
- [ ] Get-ComputerDisk - Функция предоставления данных об установленных HDD. Разработана, но фактически не используется в настоящее время
- [x] Get-ComputerDiskLogical -Функция предоставления данных о логических разделах ОС
- [x] Get-ComputerProcess - Функция вывода запущенных процессов
- [x] Get-ComputerService - Функция вывода состояния сервисов
- [x] Start-Inventory - Функция сбора всех параметров и предоставления объектов для выгрухки в форматы Excel и JSON

### Конфигурационный файл
Файл имеет однозначную структуру. По ходу развития скрипта, структура может быть расширена.

Пример структуры:

```powershell
# Обязательные директивы проверки версии PoSH v5 и скрипт должен быть запущен с повышенными привилегиями
#requires -Version 5
#requires -RunAsAdministrator

# Описание структуры переменных, добавление и изменение переменных возможно, с изменением модуля ISSC
$Options = [ordered] @{

    AsExcel = @{
		Enabled	    = $false # Сохранять в XLSX
		Path	    = 'ПУТЬ_Хранения_C:\TEMP\'
		DateFormat  = 'ddMMyyyy' #Формат даты используемой в формировании названия файла
		}
	
	AsJSON   = @{
		Enabled    = $true # сохранять в JSON
		Compress   = $true # Включает\отключает сжатие файла
		Path	    = 'ПУТЬ_Хранения_C:\TEMP\'
		DateFormat  = 'HH_mm-dd-MM-yyyy' #Формат даты используемой в формировании названия файла
	}
	
	Logging = @{ #Логирование
		ShowTime   = $true #указание даты и времени в Log файлах
		LogsDir    = 'ПУТЬ_Хранения_C:\TEMP\' #путь до Log файла выполнеиня скрипта
		LogFile    = 'Loging.log' # Log файл
		ErrLogdir = 'ПУТЬ_Хранения_C:\TEMP\' # Путь до Log файла ошибок при выполнении скрипта
		ErrLogFile = 'Error.log' # Log файл
		LogTimeFormat = 'HH:mm:ss dd/MM/yyyy' # Фармат Дата\Время, отображаемая в лог файлах
			}
	
	# Конфигурация источников информации
	StandaloneWrk = [ordered] @{ # Рабочие станции указанные в ручную
			Enabled = $true # использовать поиск в списке
			ArrWrk = 'win7-pc','jmike','dc' # список ПК, указанный через запятую
		}
	DomainWrk = [ordered] @{ # Поиск рабочих станций в домене, в указанных OU. Если OU не указана, то поиск по всем OU в домене
		Enabled = $false # признак использования конфигурации
		CheckUO = '' # Если не указана OU, То искать во всех
		DCName  = '' # Если не указан DC ,то список OU получить с любого DC
		}
    
    #Работа с модулями
    CheckModule = [ordered] @{
		ALL  = $false # Использовать все доступные модули, не зависимо от указанных ниже
		
		Name = [ordered] @{
			SystemInfo 		 = $false # получение информации об операционной системе
			NetStat		     = $false # получение результата выполнения команды "NETSTAT.EXE -ANO"
			NIC			     = $false # получение информации о сетевых интерфейсах, имеющих возможность установки IP, исключаются виртуальные коммутаторы и прочее
			Udates		     = $false # получение информации об установленных обновлениях 
			LocalAdmin	     = $false # получение информации о пользователях в группе Локальные Администраторы
			SharedFolders    = $false # Получение информации о ресурсах, предоставленных в общее пользование
			InstalledApp	 = $true  # Получение списка установленного ПО
			PersistentRoutes = $false # Получение списка статических маршрутов
			OSProcesses	     = $true  # Получение запущенных процессов
			OSServices	     = $true  # Получение списка сервисов и их статуса
			OSMissingDrivers = $false # Получение списка ошибок в Диспетчере устройств
			OSLoggingUser    = $false # получение списка пользователей и сервисных УЗ зарегистрированных на ПК
		}
		
		
	}
	
}

# локальный импорт необходимых модулей
Import-Module -Name 'C:\temp\PSWriteExcel'
Import-Module -Name 'C:\temp\ISSC'

cls #старт командлета сбора статистики

start-Inventory $options
```
